<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=X-UA-Compatible content="IE=edge, chrome=1"><title>Potential Issues With Spring Jpa Properties You Should Avoid in Production - William Yu</title><meta name=Description content="William Yu's Blog"><meta property="og:title" content="Potential Issues With Spring Jpa Properties You Should Avoid in Production">
<meta property="og:description" content="Introduction Java developers love the Spring Framework since it has gained immense popularity due to its simplicity, flexibility, and robustness. Spring is a powerful tool that simplifies the development of enterprise applications by providing various features and functionalities. One such feature is the Spring Data JPA, which is an abstraction over the JPA specification. Although Spring Boot provides a powerful auto-configuration feature that makes it easy to configure and set up various components of an application, misconfiguring certain properties can lead to unintended consequences and potential issues."><meta property="og:type" content="article"><meta property="og:url" content="https://williamyuaus.com/2023/03/potential-issues-with-spring-jpa-properties-you-should-avoid-in-production/"><meta property="og:image" content="https://williamyuaus.com/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-03-31T15:34:29+11:00"><meta property="article:modified_time" content="2023-03-31T15:34:29+11:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://williamyuaus.com/logo.png"><meta name=twitter:title content="Potential Issues With Spring Jpa Properties You Should Avoid in Production"><meta name=twitter:description content="Introduction Java developers love the Spring Framework since it has gained immense popularity due to its simplicity, flexibility, and robustness. Spring is a powerful tool that simplifies the development of enterprise applications by providing various features and functionalities. One such feature is the Spring Data JPA, which is an abstraction over the JPA specification. Although Spring Boot provides a powerful auto-configuration feature that makes it easy to configure and set up various components of an application, misconfiguring certain properties can lead to unintended consequences and potential issues."><meta name=twitter:site content="@williamyuaus"><meta name=application-name content="William Yu"><meta name=apple-mobile-web-app-title content="William Yu"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://williamyuaus.com/2023/03/potential-issues-with-spring-jpa-properties-you-should-avoid-in-production/><link rel=prev href=https://williamyuaus.com/2023/01/increasing-the-size-of-the-disk-of-vm/><link rel=next href=https://williamyuaus.com/2023/08/disable-the-error-notification-toast-when-generating-pdf-from-a-vue-project/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Potential Issues With Spring Jpa Properties You Should Avoid in Production","inLanguage":"en-us","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/williamyuaus.com\/2023\/03\/potential-issues-with-spring-jpa-properties-you-should-avoid-in-production\/"},"genre":"posts","keywords":"Spring JPA, Hibernate, Debug","wordcount":790,"url":"https:\/\/williamyuaus.com\/2023\/03\/potential-issues-with-spring-jpa-properties-you-should-avoid-in-production\/","datePublished":"2023-03-31T15:34:29+11:00","dateModified":"2023-03-31T15:34:29+11:00","publisher":{"@type":"Organization","name":"William Yu"},"author":{"@type":"Person","name":"William Yu"},"description":""}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><script async src=https://cdn.splitbee.io/sb.js></script><div class=header-wrapper><div class=header-title><a href=/ title="William Yu"><img class="lazyload logo" src=/svg/loading.min.svg data-src=https://raw.githubusercontent.com/williamyuaus/blog-img/master/img/202212181057858.png data-srcset="https://raw.githubusercontent.com/williamyuaus/blog-img/master/img/202212181057858.png, https://raw.githubusercontent.com/williamyuaus/blog-img/master/img/202212181057858.png 1.5x, https://raw.githubusercontent.com/williamyuaus/blog-img/master/img/202212181057858.png 2x" data-sizes=auto alt=https://raw.githubusercontent.com/williamyuaus/blog-img/master/img/202212181057858.png title=https://raw.githubusercontent.com/williamyuaus/blog-img/master/img/202212181057858.png>William Yu</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href=/about/>About </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><script async src=https://cdn.splitbee.io/sb.js></script><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="William Yu"><img class="lazyload logo" src=/svg/loading.min.svg data-src=https://raw.githubusercontent.com/williamyuaus/blog-img/master/img/202212181057858.png data-srcset="https://raw.githubusercontent.com/williamyuaus/blog-img/master/img/202212181057858.png, https://raw.githubusercontent.com/williamyuaus/blog-img/master/img/202212181057858.png 1.5x, https://raw.githubusercontent.com/williamyuaus/blog-img/master/img/202212181057858.png 2x" data-sizes=auto alt=https://raw.githubusercontent.com/williamyuaus/blog-img/master/img/202212181057858.png title=https://raw.githubusercontent.com/williamyuaus/blog-img/master/img/202212181057858.png>William Yu</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a class=menu-item href=/about/ title>About</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">Potential Issues With Spring Jpa Properties You Should Avoid in Production</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://williamyuaus.com title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw"></i>William Yu</a></span>&nbsp;<span class=post-category>included in <a href=/categories/spring-jpa/><i class="far fa-folder fa-fw"></i>Spring JPA</a>&nbsp;<a href=/categories/hibernate/><i class="far fa-folder fa-fw"></i>Hibernate</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2023-03-31>2023-03-31</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;790 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;4 minutes&nbsp;</div></div><div class=featured-image><img class=lazyload src=/svg/loading.min.svg data-src=https://raw.githubusercontent.com/williamyuaus/blog-img/master/img/202303311535597.png data-srcset="https://raw.githubusercontent.com/williamyuaus/blog-img/master/img/202303311535597.png, https://raw.githubusercontent.com/williamyuaus/blog-img/master/img/202303311535597.png 1.5x, https://raw.githubusercontent.com/williamyuaus/blog-img/master/img/202303311535597.png 2x" data-sizes=auto alt=https://raw.githubusercontent.com/williamyuaus/blog-img/master/img/202303311535597.png title=https://raw.githubusercontent.com/williamyuaus/blog-img/master/img/202303311535597.png></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#what-is-spring-jpa-hibernate-ddl-auto>What is Spring JPA Hibernate DDL-Auto?</a></li><li><a href=#ddl-auto-modes>DDL-Auto Modes</a><ul><li><a href=#create>create</a></li><li><a href=#create-drop>create-drop</a></li><li><a href=#validate>validate</a></li><li><a href=#update>update</a></li><li><a href=#none>none</a></li></ul></li><li><a href=#how-is-the-misconfiguration-caused-problem>How is the misconfiguration caused problem</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></div><div class=content id=content><h2 id=introduction>Introduction</h2><p>Java developers love the Spring Framework since it has gained immense popularity due to its simplicity, flexibility, and robustness. Spring is a powerful tool that simplifies the development of enterprise applications by providing various features and functionalities. One such feature is the Spring Data JPA, which is an abstraction over the JPA specification. Although Spring Boot provides a powerful auto-configuration feature that makes it easy to configure and set up various components of an application, misconfiguring certain properties can lead to unintended consequences and potential issues. In this article, we will focus on two Spring JPA properties, &ldquo;spring.jpa.hibernate.ddl-auto&rdquo; and &ldquo;spring.jpa.generate-ddl,&rdquo; and discuss the potential issues that can arise from misconfiguring them.</p><h2 id=what-is-spring-jpa-hibernate-ddl-auto>What is Spring JPA Hibernate DDL-Auto?</h2><p>Spring Data JPA uses Hibernate as its default JPA implementation. Hibernate is a powerful and widely used ORM framework in the Java ecosystem. One of the most critical aspects of any application that interacts with a database is the database schema. The schema defines the structure of the database tables, their relationships, and constraints. In traditional database-driven applications, developers often create the database schema manually using SQL scripts. However, this can be a tedious and error-prone process, especially when dealing with complex database structures.</p><p>Spring JPA Hibernate DDL-Auto is a configuration property that allows Spring to automatically generate and manage the database schema. DDL stands for Data Definition Language, and it refers to the SQL commands used to create and modify database structures. When we set the value of spring.jpa.hibernate.ddl-auto to a specific mode, Spring boot automatically generates and executes the necessary DDL statements to create and modify the database schema at startup time.</p><h2 id=ddl-auto-modes>DDL-Auto Modes</h2><p>Spring JPA Hibernate DDL-Auto provides several modes that we can set to define how Spring manages the database schema. The available modes are:</p><ol><li>create</li><li>create-drop</li><li>validate</li><li>update</li><li>none</li></ol><p>Let&rsquo;s look at each mode in detail.</p><h3 id=create>create</h3><p>In the create mode, Spring creates the database schema from scratch at startup time. If the database schema already exists, Spring drops it and creates a new schema. This mode is useful during the development phase when we want to create a clean database structure each time we run the application.</p><h3 id=create-drop>create-drop</h3><p>In the create-drop mode, Spring creates the database schema at startup time and drops it when the application shuts down. This mode is useful during development and testing when we want to create and destroy the database schema multiple times.</p><h3 id=validate>validate</h3><p>In the validate mode, Spring validates the database schema against the entity classes at startup time. If there is a mismatch between the schema and the entities, Spring throws an exception. This mode is useful in production environments when we want to ensure that the database schema matches the entity classes.</p><h3 id=update>update</h3><p>In the update mode, Spring updates the database schema to match the entity classes at startup time. This mode adds new tables, columns, and constraints to the existing schema and modifies the schema to match any changes in the entity classes. This mode is useful during development and testing when we want to modify the database schema without dropping the existing data.</p><h3 id=none>none</h3><p>In the none mode, Spring does not manage the database schema. This mode is useful when we want to manage the database schema manually or when we use an existing schema that we don&rsquo;t want Spring to modify.</p><h2 id=how-is-the-misconfiguration-caused-problem>How is the misconfiguration caused problem</h2><p>For my current project, I have set the Spring JPA as follows:</p><pre tabindex=0><code>  jpa:
    generate-ddl: &#39;true&#39;
    hibernate:
      ddl-auto: update
</code></pre><p>It caused the problem when we deployed the app, the database migration was failed due to some columns were existed already. Even we tried to drop all the tables and schemes, but the issue was still presented.</p><p>When I found the root cause is the misconfiguration of Spring JPA. I changed it to:</p><pre tabindex=0><code>jpa:
    generate-ddl: &#39;false&#39;
    hibernate:
      ddl-auto: none
</code></pre><p>It fixed the issue immediately. However, it may not be a best practise for both dev and production environment. So, we make it into a local profile in the <code>application.yml</code>.</p><pre tabindex=0><code>---
spring:
  config:
    activate:
      on-profile: local
  datasource:
    readonly:
      initialization-mode: always
  jpa:
    generate-ddl: &#39;true&#39;
    hibernate:
      ddl-auto: update
</code></pre><h2 id=conclusion>Conclusion</h2><p>In this article, we explored the Spring JPA Hibernate DDL-Auto configuration property and its modes. Spring JPA Hibernate DDL-Auto provides an easy and efficient way to manage the database schema using ORM techniques. By setting the value of this property, we can control how Spring creates and modifies the database schema at startup time. This feature is particularly useful during the development and testing phases of an application when we want to create and modify the database schema frequently.</p><p>A misconfiguration of these properties may cause issues in production environment. So, the best practise for this is to locate them into a local profile.</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2023-03-31</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/spring-jpa/>Spring JPA</a>,&nbsp;<a href=/tags/hibernate/>Hibernate</a>,&nbsp;<a href=/tags/debug/>Debug</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/2023/01/increasing-the-size-of-the-disk-of-vm/ class=prev rel=prev title="Increasing the Size of the Disk of VM"><i class="fas fa-angle-left fa-fw"></i>Increasing the Size of the Disk of VM</a>
<a href=/2023/08/disable-the-error-notification-toast-when-generating-pdf-from-a-vue-project/ class=next rel=next title="Disabling Error Notification Toast when Generating PDF from a Vue Project">Disabling Error Notification Toast when Generating PDF from a Vue Project<i class="fas fa-angle-right fa-fw"></i></a></div></div><div id=comments><div id=utterances></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://utteranc.es/>Utterances</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2020 - 2024</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://williamyuaus.com target=_blank>William Yu</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/twemoji/twemoji.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:10},comment:{utterances:{darkTheme:"github-dark",issueTerm:"pathname",label:"",lightTheme:"github-light",repo:"williamyuaus/blog_comments"}},twemoji:!0}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>