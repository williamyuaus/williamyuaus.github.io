<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Fix the Error of Null Value for Field With @Creationtimestamp - William Yu</title><meta name=Description content="William Yu's Blog"><meta property="og:title" content="Fix the Error of Null Value for Field With @Creationtimestamp">
<meta property="og:description" content="Background In a Spring Boot project, an entity class has a @CreationTimestamp annotation for the field of started. Since this field is essential for our business logic, there is a NotNull restriction in the database column for it.
This is the code for this entity (Review.java):
@Entity(name = &#34;review&#34;) @EqualsAndHashCode(onlyExplicitlyIncluded = true) @TypeDef(name = &#34;jsonb&#34;, typeClass = JsonBinaryType.class) @TypeDef(name = &#34;pgsql_enum&#34;, typeClass = PostgreSQLEnumType.class) @Getter @Setter @JsonIgnoreProperties({&#34;hibernateLazyInitializer&#34;, &#34;handler&#34;}) public class Review { @Id @EqualsAndHashCode."><meta property="og:type" content="article"><meta property="og:url" content="https://williamyuaus.com/2024/01/fix-the-error-of-null-value-for-field-with-creationtimestamp/"><meta property="og:image" content="https://williamyuaus.com/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-01-22T10:43:32+11:00"><meta property="article:modified_time" content="2024-01-22T10:43:32+11:00"><meta property="og:site_name" content="My cool site"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://williamyuaus.com/logo.png"><meta name=twitter:title content="Fix the Error of Null Value for Field With @Creationtimestamp"><meta name=twitter:description content="Background In a Spring Boot project, an entity class has a @CreationTimestamp annotation for the field of started. Since this field is essential for our business logic, there is a NotNull restriction in the database column for it.
This is the code for this entity (Review.java):
@Entity(name = &#34;review&#34;) @EqualsAndHashCode(onlyExplicitlyIncluded = true) @TypeDef(name = &#34;jsonb&#34;, typeClass = JsonBinaryType.class) @TypeDef(name = &#34;pgsql_enum&#34;, typeClass = PostgreSQLEnumType.class) @Getter @Setter @JsonIgnoreProperties({&#34;hibernateLazyInitializer&#34;, &#34;handler&#34;}) public class Review { @Id @EqualsAndHashCode."><meta name=twitter:site content="@williamyuaus"><meta name=application-name content="My cool site"><meta name=apple-mobile-web-app-title content="My cool site"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://williamyuaus.com/2024/01/fix-the-error-of-null-value-for-field-with-creationtimestamp/><link rel=prev href=https://williamyuaus.com/2023/08/disable-the-error-notification-toast-when-generating-pdf-from-a-vue-project/><link rel=next href=https://williamyuaus.com/2024/02/set-up-vs-code-for-remote-development/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Fix the Error of Null Value for Field With @Creationtimestamp","inLanguage":"en-us","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/williamyuaus.com\/2024\/01\/fix-the-error-of-null-value-for-field-with-creationtimestamp\/"},"genre":"posts","keywords":"Spring Boot, Debug, Hibernate","wordcount":466,"url":"https:\/\/williamyuaus.com\/2024\/01\/fix-the-error-of-null-value-for-field-with-creationtimestamp\/","datePublished":"2024-01-22T10:43:32+11:00","dateModified":"2024-01-22T10:43:32+11:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"William Yu"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="William Yu"><img class="lazyload logo" src=/svg/loading.min.svg data-src=https://raw.githubusercontent.com/williamyuaus/blog-img/master/img/202212181057858.png data-srcset="https://raw.githubusercontent.com/williamyuaus/blog-img/master/img/202212181057858.png, https://raw.githubusercontent.com/williamyuaus/blog-img/master/img/202212181057858.png 1.5x, https://raw.githubusercontent.com/williamyuaus/blog-img/master/img/202212181057858.png 2x" data-sizes=auto alt=https://raw.githubusercontent.com/williamyuaus/blog-img/master/img/202212181057858.png title=https://raw.githubusercontent.com/williamyuaus/blog-img/master/img/202212181057858.png>William Yu</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href=/about/>About </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="William Yu"><img class="lazyload logo" src=/svg/loading.min.svg data-src=https://raw.githubusercontent.com/williamyuaus/blog-img/master/img/202212181057858.png data-srcset="https://raw.githubusercontent.com/williamyuaus/blog-img/master/img/202212181057858.png, https://raw.githubusercontent.com/williamyuaus/blog-img/master/img/202212181057858.png 1.5x, https://raw.githubusercontent.com/williamyuaus/blog-img/master/img/202212181057858.png 2x" data-sizes=auto alt=https://raw.githubusercontent.com/williamyuaus/blog-img/master/img/202212181057858.png title=https://raw.githubusercontent.com/williamyuaus/blog-img/master/img/202212181057858.png>William Yu</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a class=menu-item href=/about/ title>About</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Fix the Error of Null Value for Field With @Creationtimestamp</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://williamyuaus.com title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>William Yu</a></span>&nbsp;<span class=post-category>included in <a href=/categories/spring-boot/><i class="far fa-folder fa-fw" aria-hidden=true></i>Spring Boot</a>&nbsp;<a href=/categories/debug/><i class="far fa-folder fa-fw" aria-hidden=true></i>Debug</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2024-01-22>2024-01-22</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;466 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;3 minutes&nbsp;</div></div><div class=featured-image><img class=lazyload src=/svg/loading.min.svg data-src=https://raw.githubusercontent.com/williamyuaus/blog-img/master/img/202401221050208.png data-srcset="https://raw.githubusercontent.com/williamyuaus/blog-img/master/img/202401221050208.png, https://raw.githubusercontent.com/williamyuaus/blog-img/master/img/202401221050208.png 1.5x, https://raw.githubusercontent.com/williamyuaus/blog-img/master/img/202401221050208.png 2x" data-sizes=auto alt=https://raw.githubusercontent.com/williamyuaus/blog-img/master/img/202401221050208.png title=https://raw.githubusercontent.com/williamyuaus/blog-img/master/img/202401221050208.png></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#background>Background</a></li><li><a href=#error>Error</a></li><li><a href=#solution>Solution</a></li></ul></nav></div></div><div class=content id=content><h2 id=background>Background</h2><p>In a Spring Boot project, an entity class has a @CreationTimestamp annotation for the field of started. Since this field is essential for our business logic, there is a NotNull restriction in the database column for it.</p><p>This is the code for this entity (Review.java):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;review&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@EqualsAndHashCode</span><span class=p>(</span><span class=n>onlyExplicitlyIncluded</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>true</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@TypeDef</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;jsonb&#34;</span><span class=p>,</span><span class=w> </span><span class=n>typeClass</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>JsonBinaryType</span><span class=p>.</span><span class=na>class</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@TypeDef</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;pgsql_enum&#34;</span><span class=p>,</span><span class=w> </span><span class=n>typeClass</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>PostgreSQLEnumType</span><span class=p>.</span><span class=na>class</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Getter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Setter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@JsonIgnoreProperties</span><span class=p>({</span><span class=s>&#34;hibernateLazyInitializer&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;handler&#34;</span><span class=p>})</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Review</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@EqualsAndHashCode.Include</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>UUID</span><span class=w> </span><span class=n>id</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@NotNull</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Size</span><span class=p>(</span><span class=n>max</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>255</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Column</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;description&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>description</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@NotNull</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Enumerated</span><span class=p>(</span><span class=n>EnumType</span><span class=p>.</span><span class=na>STRING</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Column</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;state&#34;</span><span class=p>,</span><span class=w> </span><span class=n>nullable</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>false</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Type</span><span class=p>(</span><span class=n>type</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;pgsql_enum&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>ReviewState</span><span class=w> </span><span class=n>state</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@NotNull</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Enumerated</span><span class=p>(</span><span class=n>EnumType</span><span class=p>.</span><span class=na>STRING</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Column</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;outcome&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Type</span><span class=p>(</span><span class=n>type</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;pgsql_enum&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>ReviewOutcome</span><span class=w> </span><span class=n>outcome</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@CreationTimestamp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Column</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;started&#34;</span><span class=p>,</span><span class=w> </span><span class=n>columnDefinition</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;TIMESTAMPTZ&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>LocalDateTime</span><span class=w> </span><span class=n>started</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Column</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;completed&#34;</span><span class=p>,</span><span class=w> </span><span class=n>columnDefinition</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;TIMESTAMPTZ&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>LocalDateTime</span><span class=w> </span><span class=n>completed</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@UpdateTimestamp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Column</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;update_date_time&#34;</span><span class=p>,</span><span class=w> </span><span class=n>columnDefinition</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;TIMESTAMPTZ&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>LocalDateTime</span><span class=w> </span><span class=n>updatedAt</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>To persist the data of the Review domain, we create a repository class for it (ReviewRepository.java):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Repository</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>interface</span> <span class=nc>ReviewRepository</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>JpaRepository</span><span class=o>&lt;</span><span class=n>Review</span><span class=p>,</span><span class=w> </span><span class=n>UUID</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>Meanwhile, we have a service layer to create a review and save it in the database:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@RequiredArgsConstructor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Slf4j</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>ReviewServiceImpl</span><span class=w> </span><span class=kd>implements</span><span class=w> </span><span class=n>ReviewService</span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>ReviewRepository</span><span class=w> </span><span class=n>reviewRepository</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Transactional</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>ReviewResponseDTO</span><span class=w> </span><span class=nf>createReview</span><span class=p>(</span><span class=n>ReviewDTO</span><span class=w> </span><span class=n>data</span><span class=p>){</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// Review Entity creation</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Review</span><span class=w> </span><span class=n>review</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>data</span><span class=p>.</span><span class=na>toEntity</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>review</span><span class=p>.</span><span class=na>setId</span><span class=p>(</span><span class=n>UUID</span><span class=p>.</span><span class=na>randomUUID</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>review</span><span class=p>.</span><span class=na>setState</span><span class=p>(</span><span class=n>ReviewState</span><span class=p>.</span><span class=na>OPEN</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>review</span><span class=p>.</span><span class=na>setOutcome</span><span class=p>(</span><span class=n>ReviewOutcome</span><span class=p>.</span><span class=na>PENDING</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// Review entity persisting to db</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Review</span><span class=w> </span><span class=n>dbReview</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>reviewRepository</span><span class=p>.</span><span class=na>saveAndFlush</span><span class=p>(</span><span class=n>review</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>dbReview</span><span class=p>.</span><span class=na>toResponseDto</span><span class=p>(</span><span class=n>Boolean</span><span class=p>.</span><span class=na>TRUE</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h2 id=error>Error</h2><p>However, when we do the testing of this, we got the error of this:</p><p><code>org.springframework.dao.DataIntegrityViolationException: could not execute statement; SQL [n/a]; constraint [started\" of relation \"review]; nested exception is org.hibernate.exception.ConstraintViolationException: could not execute statement] with root cause","context":"default","exception":"org.postgresql.util.PSQLException: ERROR: null value in column \"started\" of relation \"review\" violates not-null constraint\n Detail: Failing row contains (83aa2605-cc66-4029-854b-5f70a166c875, Review hold rules for client TEST, null, null, OPEN, PENDING, 2024-01-19 03:30:21.100613+00).\n\</code></p><p>From the logs, we can tell that the SQL statement which is generated by Hibernate, has a null value for the started field. This would be violated the not-null constraint. As a result, the review entity cannot persist to the database.</p><h2 id=solution>Solution</h2><p>After some research, I&rsquo;ve found this is caused by the Hibernate. We have to add <code>@Column(updatable = false)</code> on to the started field to make it work. This additional annotation avoids the started to be updated by the SQL statement from Hibernate. So it would be executed successfully by ignoring the null value for this field.</p><p>The updated code for Review.java:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;review&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@EqualsAndHashCode</span><span class=p>(</span><span class=n>onlyExplicitlyIncluded</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>true</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@TypeDef</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;jsonb&#34;</span><span class=p>,</span><span class=w> </span><span class=n>typeClass</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>JsonBinaryType</span><span class=p>.</span><span class=na>class</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@TypeDef</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;pgsql_enum&#34;</span><span class=p>,</span><span class=w> </span><span class=n>typeClass</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>PostgreSQLEnumType</span><span class=p>.</span><span class=na>class</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Getter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Setter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@JsonIgnoreProperties</span><span class=p>({</span><span class=s>&#34;hibernateLazyInitializer&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;handler&#34;</span><span class=p>})</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Review</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// ... [other fields remain unchanged]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@CreationTimestamp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Column</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;started&#34;</span><span class=p>,</span><span class=w> </span><span class=n>columnDefinition</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;TIMESTAMPTZ&#34;</span><span class=p>,</span><span class=w> </span><span class=n>updatable</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>false</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>LocalDateTime</span><span class=w> </span><span class=n>started</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// ... [other fields remain unchanged]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>With the updated version of entity class, the review entity can be persisted to the database without any issues.</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2024-01-22</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://williamyuaus.com/2024/01/fix-the-error-of-null-value-for-field-with-creationtimestamp/ data-title="Fix the Error of Null Value for Field With @Creationtimestamp" data-via=williamyuaus data-hashtags="Spring Boot,Debug,Hibernate"><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://williamyuaus.com/2024/01/fix-the-error-of-null-value-for-field-with-creationtimestamp/ data-hashtag="Spring Boot"><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://williamyuaus.com/2024/01/fix-the-error-of-null-value-for-field-with-creationtimestamp/ data-title="Fix the Error of Null Value for Field With @Creationtimestamp"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://williamyuaus.com/2024/01/fix-the-error-of-null-value-for-field-with-creationtimestamp/ data-title="Fix the Error of Null Value for Field With @Creationtimestamp"><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://williamyuaus.com/2024/01/fix-the-error-of-null-value-for-field-with-creationtimestamp/ data-title="Fix the Error of Null Value for Field With @Creationtimestamp" data-image=https://raw.githubusercontent.com/williamyuaus/blog-img/master/img/202401221050208.png><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/spring-boot/>Spring Boot</a>,&nbsp;<a href=/tags/debug/>Debug</a>,&nbsp;<a href=/tags/hibernate/>Hibernate</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/2023/08/disable-the-error-notification-toast-when-generating-pdf-from-a-vue-project/ class=prev rel=prev title="Disabling Error Notification Toast when Generating PDF from a Vue Project"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>Disabling Error Notification Toast when Generating PDF from a Vue Project</a>
<a href=/2024/02/set-up-vs-code-for-remote-development/ class=next rel=next title="Set Up VS Code for Remote Development">Set Up VS Code for Remote Development<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div id=comments><div id=utterances class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://utteranc.es/>utterances</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2020 - 2024</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://williamyuaus.com target=_blank>William Yu</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/twemoji@14.0.2/dist/twemoji.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:10},comment:{utterances:{darkTheme:"github-dark",issueTerm:"pathname",label:"",lightTheme:"github-light",repo:"williamyuaus/blog_comments"}},twemoji:!0}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>